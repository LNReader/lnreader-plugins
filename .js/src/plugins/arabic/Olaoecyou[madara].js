var e=this&&this.__awaiter||function(e,a,l,t){return new(l||(l=Promise))((function(n,r){function u(e){try{o(t.next(e))}catch(e){r(e)}}function i(e){try{o(t.throw(e))}catch(e){r(e)}}function o(e){var a;e.done?n(e.value):(a=e.value,a instanceof l?a:new l((function(e){e(a)}))).then(u,i)}o((t=t.apply(e,a||[])).next())}))},a=this&&this.__generator||function(e,a){var l,t,n,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=i(0),u.throw=i(1),u.return=i(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(o){return function(i){if(l)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(r=0)),r;)try{if(l=1,t&&(n=2&i[0]?t.return:i[0]?t.throw||((n=t.return)&&n.call(t),0):t.next)&&!(n=n.call(t,i[1])).done)return n;switch(t=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,t=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(n=r.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){r.label=i[1];break}if(6===i[0]&&r.label<n[1]){r.label=n[1],n=i;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(i);break}n[2]&&r.ops.pop(),r.trys.pop();continue}i=a.call(e,r)}catch(e){i=[6,e],t=0}finally{l=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@libs/fetch"),n=require("cheerio"),r=require("@libs/defaultCover"),u=require("@libs/novelStatus"),i=l(require("dayjs")),o=require("@libs/storage"),s=function(e,a){return new RegExp(a.join("|")).test(e)},v=new(function(){function l(e){var a,l;this.hideLocked=o.storage.get("hideLocked"),this.parseData=function(e){var a,l=(0,i.default)(),t=(null===(a=e.match(/\d+/))||void 0===a?void 0:a[0])||"",n=parseInt(t,10);if(!t)return e;if(s(e,["detik","segundo","second","วินาที"]))l=l.subtract(n,"second");else if(s(e,["menit","dakika","min","minute","minuto","นาที","دقائق"]))l=l.subtract(n,"minute");else if(s(e,["jam","saat","heure","hora","hour","ชั่วโมง","giờ","ore","ساعة","小时"]))l=l.subtract(n,"hours");else if(s(e,["hari","gün","jour","día","dia","day","วัน","ngày","giorni","أيام","天"]))l=l.subtract(n,"days");else if(s(e,["week","semana"]))l=l.subtract(n,"week");else if(s(e,["month","mes"]))l=l.subtract(n,"month");else{if(!s(e,["year","año"]))return"Invalid Date"!==(0,i.default)(e).format("LL")?(0,i.default)(e).format("LL"):e;l=l.subtract(n,"year")}return l.format("LL")},this.id=e.id,this.name=e.sourceName,this.icon="multisrc/madara/".concat(e.id.toLowerCase(),"/icon.png"),this.site=e.sourceSite;var t=(null===(a=e.options)||void 0===a?void 0:a.versionIncrements)||0;this.version="1.0.".concat(8+t),this.options=e.options,this.filters=e.filters,(null===(l=this.options)||void 0===l?void 0:l.hasLocked)&&(this.pluginSettings={hideLocked:{value:"",label:"Hide locked chapters",type:"Switch"}})}return l.prototype.translateDragontea=function(e){var a;if("dragontea"!==this.id)return e;var l=(0,n.load)((null===(a=e.html())||void 0===a?void 0:a.replace("\n","").replace(/<br\s*\/?>/g,"\n"))||"");return e.html(l.html()),e.find("*").addBack().contents().filter((function(e,a){return 3===a.nodeType})).each((function(e,a){var t=l(a),n=t.text().normalize("NFD").split("").map((function(e){var a=e.normalize("NFC"),l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a);return l>=0?"zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA"[l]+e.slice(a.length):e})).join("");t.replaceWith(n.replace("\n","<br>"))})),e},l.prototype.getHostname=function(e){var a=(e=e.split("/")[2]).split(".");return a.pop(),a.join(".")},l.prototype.getCheerio=function(l,r){return e(this,void 0,void 0,(function(){var e,u,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,(0,t.fetchApi)(l)];case 1:if(!(e=a.sent()).ok&&1!=r)throw new Error("Could not reach site ("+e.status+") try to open in webview.");return i=n.load,[4,e.text()];case 2:if(u=i.apply(void 0,[a.sent()]),o=u("title").text().trim(),this.getHostname(l)!=this.getHostname(e.url)||"Bot Verification"==o||"You are being redirected..."==o||"Un instant..."==o||"Just a moment..."==o||"Redirecting..."==o)throw new Error("Captcha error, please open in webview");return[2,u]}}))}))},l.prototype.parseNovels=function(e){var a=[];return e(".manga-title-badges").remove(),e(".page-item-detail, .c-tabs-item__content").each((function(l,t){var n=e(t).find(".post-title").text().trim(),u=e(t).find(".post-title").find("a").attr("href")||"";if(n&&u){var i=e(t).find("img"),o={name:n,cover:i.attr("data-src")||i.attr("src")||i.attr("data-lazy-srcset")||r.defaultCover,path:u.replace(/https?:\/\/.*?\//,"/")};a.push(o)}})),a},l.prototype.popularNovels=function(l,t){return e(this,arguments,void 0,(function(e,l){var t,n,r,u,i,o,s=l.filters,v=l.showLatestNovels;return a(this,(function(a){switch(a.label){case 0:for(n in t=this.site+"/page/"+e+"/?s=&post_type=wp-manga",s||(s=this.filters||{}),v&&(t+="&m_orderby=latest"),s)if("object"==typeof s[n].value)for(r=0,u=s[n].value;r<u.length;r++)i=u[r],t+="&".concat(n,"=").concat(i);else s[n].value&&(t+="&".concat(n,"=").concat(s[n].value));return[4,this.getCheerio(t,1!=e)];case 1:return o=a.sent(),[2,this.parseNovels(o)]}}))}))},l.prototype.parseNovel=function(l){return e(this,void 0,void 0,(function(){var e,o,s,v,b,c,h,p,d=this;return a(this,(function(a){switch(a.label){case 0:return[4,this.getCheerio(this.site+l,!1)];case 1:return(e=a.sent())(".manga-title-badges, #manga-title span").remove(),(o={path:l,name:e(".post-title h1").text().trim()||e("#manga-title h1").text().trim()||e(".manga-title").text().trim()||""}).cover=e(".summary_image > a > img").attr("data-lazy-src")||e(".summary_image > a > img").attr("data-src")||e(".summary_image > a > img").attr("src")||r.defaultCover,e(".post-content_item, .post-content").each((function(){var a=e(this).find("h5").text().trim(),l=e(this).find(".summary-content")||e(this).find(".summary_content");switch(a){case"Genre(s)":case"Genre":case"Tags(s)":case"Tag(s)":case"Tags":case"Género(s)":case"Kategori":case"التصنيفات":o.genres?o.genres+=", "+l.find("a").map((function(a,l){return e(l).text()})).get().join(", "):o.genres=l.find("a").map((function(a,l){return e(l).text()})).get().join(", ");break;case"Author(s)":case"Author":case"Autor(es)":case"المؤلف":case"المؤلف (ين)":o.author=l.text().trim();break;case"Status":case"Novel":case"Estado":case"Durum":o.status=l.text().trim().includes("OnGoing")||l.text().trim().includes("مستمرة")?u.NovelStatus.Ongoing:u.NovelStatus.Completed;break;case"Artist(s)":o.artist=l.text().trim()}})),o.genres||(o.genres=e(".genres-content").text().trim()),o.status||(o.status=e(".manga-status").text().trim().includes("OnGoing")?u.NovelStatus.Ongoing:u.NovelStatus.Completed),o.author||(o.author=e(".manga-author a").text().trim()),o.rating||(o.rating=parseFloat(e(".post-rating span").text().trim())),o.author||(o.author=e(".manga-authors").text().trim()),e("div.summary__content .code-block,script,noscript").remove(),o.summary=this.translateDragontea(e("div.summary__content")).text().trim()||e("#tab-manga-about").text().trim()||e('.post-content_item h5:contains("Summary")').next().find("span").map((function(a,l){return e(l).text()})).get().join("\n\n").trim()||e(".manga-summary p").map((function(a,l){return e(l).text()})).get().join("\n\n").trim()||e(".manga-excerpt p").map((function(a,l){return e(l).text()})).get().join("\n\n").trim(),s=[],v="",(null===(p=this.options)||void 0===p?void 0:p.useNewChapterEndpoint)?[4,(0,t.fetchApi)(this.site+l+"ajax/chapters/",{method:"POST",referrer:this.site+l}).then((function(e){return e.text()}))]:[3,3];case 2:return v=a.sent(),[3,5];case 3:return b=e(".rating-post-id").attr("value")||e("#manga-chapters-holder").attr("data-id")||"",(c=new FormData).append("action","manga_get_chapters"),c.append("manga",b),[4,(0,t.fetchApi)(this.site+"wp-admin/admin-ajax.php",{method:"POST",body:c}).then((function(e){return e.text()}))];case 4:v=a.sent(),a.label=5;case 5:return"0"!==v&&(e=(0,n.load)(v)),h=e(".wp-manga-chapter").length,e(".wp-manga-chapter").each((function(a,l){var t=e(l).find("a").text().trim(),n=l.attribs.class.includes("premium-block");n&&(t="🔒 "+t);var r=e(l).find("span.chapter-release-date").text().trim();r=r?d.parseData(r):(0,i.default)().format("LL");var u=e(l).find("a").attr("href")||"";!u||"#"==u||n&&d.hideLocked||s.push({name:t,path:u.replace(/https?:\/\/.*?\//,"/"),releaseTime:r||null,chapterNumber:h-a})})),o.chapters=s.reverse(),[2,o]}}))}))},l.prototype.parseChapter=function(l){return e(this,void 0,void 0,(function(){var e,t,n;return a(this,(function(a){switch(a.label){case 0:return[4,this.getCheerio(this.site+l,!1)];case 1:return e=a.sent(),t=e(".text-left")||e(".text-right")||e(".entry-content")||e(".c-blog-post > div > div:nth-child(2)"),null===(n=this.options)||void 0===n||n.customJs,[2,this.translateDragontea(t).html()||""]}}))}))},l.prototype.searchNovels=function(l,t){return e(this,void 0,void 0,(function(){var e,n;return a(this,(function(a){switch(a.label){case 0:return e=this.site+"/page/"+t+"/?s="+encodeURIComponent(l)+"&post_type=wp-manga",[4,this.getCheerio(e,!0)];case 1:return n=a.sent(),[2,this.parseNovels(n)]}}))}))},l}())({id:"olaoe",sourceSite:"https://olaoe.cyou/",sourceName:"Olaoe.cyou",options:{useNewChapterEndpoint:!0,lang:"Arabic"},filters:{"genre[]":{type:"Checkbox",label:"Genre",value:[],options:[{label:"+13",value:"13"},{label:"+16",value:"16"},{label:"+17",value:"17"},{label:"Custom Genre 1",value:"custom-genre-1"},{label:"Custom Genre 2",value:"custom-genre-2"},{label:"Custom Genre 3",value:"custom-genre-3"},{label:"أكشن",value:"أكشن"},{label:"إثارة",value:"إثارة"},{label:"إعادة إحياء",value:"إعادة-إحياء"},{label:"إنتقام",value:"إنتقام"},{label:"إيتشي",value:"إيتشي"},{label:"اثارة",value:"اثارة"},{label:"اثاره",value:"اثاره"},{label:"اساطير",value:"اساطير"},{label:"اشباح",value:"اشباح"},{label:"اضطهاد",value:"اضطهاد"},{label:"اعادة احياء",value:"اعادة-احياء"},{label:"اعاده بحث",value:"اعاده-بحث"},{label:"اقتباس مانجا",value:"اقتباس-مانجا"},{label:"اقتباس مانهوا",value:"اقتباس-مانهوا"},{label:"اقتباس مانهوا",value:"اقتباس-مانهوا-انمي"},{label:"اكشن",value:"اكشن"},{label:"الحياة المدرسيه",value:"الحياة-المدرسيه"},{label:"الحياة اليومية",value:"الحياة-اليومية"},{label:"السفر عبر الزمن",value:"السفر-عبر-الزمن"},{label:"العاب",value:"العاب"},{label:"العاب الكترونية",value:"العاب-الكترونية"},{label:"العاب فيديو",value:"العاب-فيديو"},{label:"النجاة",value:"النجاة"},{label:"الهة",value:"الهة"},{label:"الهه",value:"الهه"},{label:"الواقع الافتراضي",value:"الواقع-الافتراضي"},{label:"امرأة شريرة",value:"امرأة-شريرة"},{label:"انتقام",value:"انتقام"},{label:"انمي",value:"انمي"},{label:"انمي ياباني",value:"انمي-ياباني"},{label:"ايتشى",value:"ايتشى"},{label:"ايتشي",value:"ايتشي"},{label:"ايسكاى",value:"ايسكاى"},{label:"بالغ",value:"بالغ"},{label:"بطل خارق",value:"بطل-خارق"},{label:"بطل غير اعتيادي",value:"بطل-غير-اعتيادي"},{label:"بوليسي",value:"بوليسي"},{label:"تاريخى",value:"تاريخى"},{label:"تاريخي",value:"تاريخي"},{label:"تجسيد",value:"تجسيد"},{label:"تحقيق",value:"تحقيق"},{label:"تراجيدي",value:"تراجيدي"},{label:"ترجمة جوجل",value:"ترجمة-جوجل"},{label:"تشويق",value:"تشويق"},{label:"تناسخ",value:"تناسخ"},{label:"تناسخ الارواح",value:"تناسخ-الارواح"},{label:"جريمة",value:"جريمة"},{label:"جريمه",value:"جريمه"},{label:"جندر اسواب",value:"جندر-اسواب"},{label:"جوسى",value:"جوسى"},{label:"جوسي",value:"جوسي"},{label:"جوسيه",value:"جوسيه"},{label:"حائز على جائزة",value:"حائز-على-جائزة"},{label:"حائز علي جائزة",value:"حائز-علي-جائزة"},{label:"حديث",value:"حديث"},{label:"حربى",value:"حربى"},{label:"حربي",value:"حربي"},{label:"حريم",value:"حريم"},{label:"حياة",value:"حياة"},{label:"حياة مدرسية",value:"حياة-مدرسية"},{label:"حياة يومية",value:"حياة-يومية"},{label:"خارق",value:"خارق"},{label:"خارق لطبيعية",value:"خارق-لطبيعية"},{label:"خارق للطبيعة",value:"خارق-للطبيعة"},{label:"خارق للطبيعه",value:"خارق-للطبيعه"},{label:"خارق للعادة",value:"خارق-للعادة"},{label:"خيال",value:"خيال"},{label:"خيال علمى",value:"خيال-علمى"},{label:"خيال علمي",value:"خيال-علمي"},{label:"خيالي",value:"خيالي"},{label:"دراما",value:"دراما"},{label:"دماء",value:"دماء"},{label:"دموى",value:"دموى"},{label:"راشد",value:"راشد"},{label:"رعب",value:"رعب"},{label:"رواية خفيفة",value:"رواية-خفيفة"},{label:"رومانسى",value:"رومانسى"},{label:"رومانسي",value:"رومانسي"},{label:"رياضة",value:"رياضة"},{label:"رياضه",value:"رياضه"},{label:"رياضى",value:"رياضى"},{label:"رياضي",value:"رياضي"},{label:"زراعة",value:"زراعة"},{label:"زمكانى",value:"زمكانى"},{label:"زمكاني",value:"زمكاني"},{label:"زمنكاني",value:"زمنكاني"},{label:"زومبي",value:"زومبي"},{label:"ساخر",value:"ساخر"},{label:"ساموراي",value:"ساموراي"},{label:"سباق",value:"سباق"},{label:"سحر",value:"سحر"},{label:"سينين",value:"سينين"},{label:"شرطة",value:"شرطة"},{label:"شريحة من الحياة",value:"شريحة-من-الحياة"},{label:"شرير",value:"شرير"},{label:"شوجو",value:"شوجو"},{label:"شونين",value:"شونين"},{label:"شياطين",value:"شياطين"},{label:"صقل",value:"صقل"},{label:"طبخ",value:"طبخ"},{label:"ّعامل مكتبي",value:"ّعامل-مكتبي"},{label:"عسكري",value:"عسكري"},{label:"عسكريه",value:"عسكريه"},{label:"علم نفس",value:"علم-نفس"},{label:"عنف",value:"عنف"},{label:"غموض",value:"غموض"},{label:"فضاء",value:"فضاء"},{label:"فلسفه",value:"فلسفه"},{label:"فلم انمي",value:"فلم-انمي"},{label:"فنتازيا",value:"فنتازيا"},{label:"فنون قتال",value:"فنون-قتال"},{label:"فنون قتالية",value:"فنون-قتالية"},{label:"فنون قتاليه",value:"فنون-قتاليه"},{label:"قتال",value:"قتال"},{label:"قوة خارقة",value:"قوة-خارقة"},{label:"قوى خارقة",value:"قوى-خارقة"},{label:"كومديا",value:"كومديا"},{label:"كوميدى",value:"كوميدى"},{label:"كوميدي",value:"كوميدي"},{label:"كوميديا",value:"كوميديا"},{label:"لعبة",value:"لعبة"},{label:"لعبه",value:"لعبه"},{label:"مأساة",value:"مأساة"},{label:"ماساة",value:"ماساة"},{label:"مافيا",value:"مافيا"},{label:"مانجا",value:"مانجا"},{label:"مانجا على الانترنت",value:"مانجا-على-الانترنت"},{label:"مانها",value:"مانها"},{label:"مانهوا",value:"مانهوا"},{label:"مجموعة قصص",value:"مجموعة-قصص"},{label:"محاكاة ساخرة",value:"محاكاة-ساخرة"},{label:"مدرسه",value:"مدرسه"},{label:"مدرسي",value:"مدرسي"},{label:"مصاصى الدماء",value:"مصاصى-الدماء"},{label:"مصاصي دماء",value:"مصاصي-دماء"},{label:"مغامرات",value:"مغامرات"},{label:"مغامرة",value:"مغامرة"},{label:"مقتبسة",value:"مقتبسة"},{label:"موريم",value:"موريم"},{label:"موسيقى",value:"موسيقى"},{label:"موسيقي",value:"موسيقي"},{label:"ميكا",value:"ميكا"},{label:"ناضج",value:"ناضج"},{label:"نظام",value:"نظام"},{label:"نفسى",value:"نفسى"},{label:"نفسي",value:"نفسي"},{label:"نينجا",value:"نينجا"},{label:"وحوش",value:"وحوش"},{label:"ويب تون",value:"ويب-تون"}]},op:{type:"Switch",label:"having all selected genres",value:!1},author:{type:"Text",label:"Author",value:""},artist:{type:"Text",label:"Artist",value:""},release:{type:"Text",label:"Year of Released",value:""},adult:{type:"Picker",label:"Adult content",value:"",options:[{label:"All",value:""},{label:"None adult content",value:"0"},{label:"Only adult content",value:"1"}]},"status[]":{type:"Checkbox",label:"Status",value:[],options:[{label:"مستمر",value:"on-going"},{label:"مكتمل",value:"end"},{label:"ملغى",value:"canceled"},{label:"في الانتظار",value:"on-hold"},{label:"قادم قريبا",value:"upcoming"}]},m_orderby:{type:"Picker",label:"Order by",value:"",options:[{label:"Relevance",value:""},{label:"Latest",value:"latest"},{label:"A-Z",value:"alphabet"},{label:"Rating",value:"rating"},{label:"Trending",value:"trending"},{label:"Most Views",value:"views"},{label:"New",value:"new-manga"}]}}});exports.default=v;