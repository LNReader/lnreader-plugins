var n=this&&this.__awaiter||function(n,t,e,i){return new(e||(e=Promise))((function(r,o){function u(n){try{a(i.next(n))}catch(n){o(n)}}function s(n){try{a(i.throw(n))}catch(n){o(n)}}function a(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,s)}a((i=i.apply(n,t||[])).next())}))},t=this&&this.__generator||function(n,t){var e,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=s(0),u.throw=s(1),u.return=s(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(s){return function(a){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;u&&(u=0,s[0]&&(o=0)),o;)try{if(e=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(n,o)}catch(n){s=[6,n],i=0}finally{e=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@libs/fetch"),i="https://uaranobe.club/",r=function(){function r(){}return r.fetch=function(r,o){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,(0,e.fetchApi)("".concat(i,"graphql"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r,variables:o})})];case 1:return[4,n.sent().json()];case 2:return[2,n.sent()]}}))}))},r.fetchChapter=function(e,i){return n(this,void 0,void 0,(function(){var n;return t(this,(function(t){switch(t.label){case 0:return n={slug:e,writingSlug:i},[4,r.fetch("\n            query EpisodeBySlug($slug: String!, $writingSlug: String!) {\n                episodeBySlug(slug: $slug, writingSlug: $writingSlug) {\n                    text\n                }\n            }\n        ",n)];case 1:return[2,t.sent().data.episodeBySlug.text]}}))}))},r.fetchNovel=function(e){return n(this,void 0,void 0,(function(){var n,i,o,u;return t(this,(function(t){switch(t.label){case 0:return n={slug:e},[4,r.fetch("\n        query Writing($slug: String!) {\n          writingBySlug(slug: $slug) {\n            id\n            title\n            originalTitle\n            image\n            slug\n            description\n            scanlators {\n              scanlator {\n                scanlatorName\n                username\n                episodes(oldestFirst: false, slug: $slug) {\n                  id\n                  subId\n                  seqTitle\n                  title\n                  slug\n                  __typename\n                }\n                __typename\n              }\n              __typename\n            }\n            genres {\n              genreId\n              genre {\n                id\n                name\n                __typename\n              }\n              __typename\n            }\n            __typename\n          }\n        }\n      ",n)];case 1:return i=t.sent(),[2,null!==(u=null===(o=null==i?void 0:i.data)||void 0===o?void 0:o.writingBySlug)&&void 0!==u?u:""]}}))}))},r.fetchListWithNovel=function(){return n(this,arguments,void 0,(function(n,e){var i;return void 0===n&&(n=0),void 0===e&&(e=""),t(this,(function(t){switch(t.label){case 0:return i={skip:n,search:e},[4,r.fetch("\n        query Writings($skip: Int!, $search: String) {\n          writingsCount(search: $search)\n          writings(skip: $skip, search: $search) {\n            id\n            title\n            image\n            slug\n            __typename\n          }\n        }\n      ",i)];case 1:return[2,t.sent().data]}}))}))},r}(),o=function(){function e(){this.id="uaranobeclub",this.name="UA Ranobe Club",this.site=i,this.version="1.1.4",this.icon="src/uk/".concat(this.id,"/icon.png")}return e.prototype.popularNovels=function(e){return n(this,void 0,void 0,(function(){var n,i,o;return t(this,(function(t){switch(t.label){case 0:return n=10*(e-1),[4,r.fetchListWithNovel(n,"")];case 1:return i=t.sent(),[2,(null!==(o=null==i?void 0:i.writings)&&void 0!==o?o:[]).map((function(n){return{name:n.title,cover:n.image,path:n.slug}}))]}}))}))},e.prototype.parseNovel=function(e){return n(this,void 0,void 0,(function(){var n,o,u,s,a,c,l,h,f;return t(this,(function(t){switch(t.label){case 0:return n=e.split(i).join(""),[4,r.fetchNovel(n)];case 1:return o=t.sent(),u=(null===(h=null===(l=null===(c=null===(a=o.scanlators)||void 0===a?void 0:a[0])||void 0===c?void 0:c.scanlator)||void 0===l?void 0:l.episodes)||void 0===h?void 0:h.map((function(t){var e=t.title,i=t.seqTitle,r=t.slug,o=t.subId;return{name:"".concat(i,". ").concat(e),path:r+"#".concat(n),chapterNumber:parseInt(o,10)}})))||[],s={genres:(null===(f=o.genres)||void 0===f?void 0:f.map((function(n){return n.genre.name})).join(","))||"",chapters:u,name:o.title,path:o.slug,summary:o.description,cover:o.image},[2,s]}}))}))},e.prototype.parseChapter=function(e){return n(this,void 0,void 0,(function(){var n,o,u;return t(this,(function(t){switch(t.label){case 0:return n=e.split(i).join("").split("#"),o=n[0],u=n[1],[4,r.fetchChapter(o,u)];case 1:return[2,t.sent()]}}))}))},e.prototype.searchNovels=function(e,i){return n(this,void 0,void 0,(function(){var n,o,u;return t(this,(function(t){switch(t.label){case 0:return n=10*(i-1),[4,r.fetchListWithNovel(n,e)];case 1:return o=t.sent(),[2,(null!==(u=null==o?void 0:o.writings)&&void 0!==u?u:[]).map((function(n){return{name:n.title,cover:n.image,path:n.slug}}))]}}))}))},e}();exports.default=new o;